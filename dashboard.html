<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>6–í–º–µ—Å—Ç–µ - –ß–∞—Ç –∫–ª–∞—Å—Å–∞</title>
    <link rel="stylesheet" href="style.css">
    <!-- –ú–∞–Ω–∏—Ñ–µ—Å—Ç –¥–ª—è PWA -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#0033a0">

<!-- –î–ª—è iOS -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="/icon-192.png">
    <style>
        /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –≤–∫–ª–∞–¥–æ–∫ */
        .tabs-container {
            display: flex;
            background: var(--bg-tertiary);
            border-radius: var(--radius-full);
            padding: 4px;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
        }
        
        .tab {
            flex: 1;
            padding: 12px 16px;
            text-align: center;
            border-radius: var(--radius-full);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .tab.active {
            background: var(--accent-blue);
            color: white;
            box-shadow: var(--shadow-sm);
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .badge {
            background: var(--accent-red);
            color: white;
            border-radius: var(--radius-full);
            padding: 2px 8px;
            font-size: 0.7rem;
            margin-left: 5px;
        }
        
        /* –ú–æ–±–∏–ª—å–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è */
        .mobile-nav {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
            padding: 10px;
            z-index: 1000;
        }
        
        .mobile-nav .tabs-container {
            margin-bottom: 0;
            background: var(--bg-tertiary);
        }
        
        @media (max-width: 768px) {
            .desktop-tabs {
                display: none;
            }
            
            .mobile-nav {
                display: block;
            }
            
            .dashboard-container {
                padding-bottom: 80px;
            }
            
            .tab {
                padding: 10px;
                font-size: 0.8rem;
            }
            
            .tab i {
                font-size: 1.2rem;
            }
        }
    </style>
</head>
<body>
    <div class="flag-stripe"></div>
    
    <!-- –ú–æ–±–∏–ª—å–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è (—Å–Ω–∏–∑—É) -->
    <div class="mobile-nav">
        <div class="tabs-container">
            <div class="tab active" data-tab="chat">
                <span>üí¨</span>
                <span>–ß–∞—Ç</span>
            </div>
            <div class="tab" data-tab="users">
                <span>üë•</span>
                <span>–£—á–∞—Å—Ç–Ω–∏–∫–∏</span>
                <span class="badge" id="pending-badge-mobile" style="display: none;">0</span>
            </div>
            <div class="tab" data-tab="pm">
                <span>üíå</span>
                <span>–õ–∏—á–∫–∞</span>
                <span class="badge" id="pm-badge-mobile" style="display: none;">0</span>
            </div>
            <div class="tab" data-tab="profile">
                <span>üë§</span>
                <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
            </div>
        </div>
    </div>
    
    <div class="dashboard-container">
        <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ (–¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞) -->
        <div class="sidebar desktop-tabs">
            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 20px;">
                <span class="flag-badge"></span>
                <h2 style="margin: 0;">6<span class="z-effect">–í</span>–º–µ—Å—Ç–µ</h2>
            </div>
            
            <!-- –í–∫–ª–∞–¥–∫–∏ –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞ -->
            <div class="tabs-container" style="flex-direction: column; background: transparent; padding: 0; gap: 5px;">
                <div class="tab active" data-tab="chat" style="justify-content: flex-start;">
                    <span>üí¨</span> –û–±—â–∏–π —á–∞—Ç
                </div>
                <div class="tab" data-tab="users" style="justify-content: flex-start;">
                    <span>üë•</span> –£—á–∞—Å—Ç–Ω–∏–∫–∏
                    <span class="badge" id="pending-badge" style="margin-left: auto; display: none;">0</span>
                </div>
                <div class="tab" data-tab="pm" style="justify-content: flex-start;">
                    <span>üíå</span> –õ–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
                    <span class="badge" id="pm-badge" style="margin-left: auto; display: none;">0</span>
                </div>
                <div class="tab" data-tab="profile" style="justify-content: flex-start;">
                    <span>üë§</span> –ü—Ä–æ—Ñ–∏–ª—å
                </div>
            </div>
            
            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ -->
            <div style="margin-top: auto; padding-top: 20px; border-top: 1px solid var(--border-color);">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 40px; height: 40px; background: var(--accent-blue); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold;">
                        <span id="user-avatar">üë§</span>
                    </div>
                    <div>
                        <div style="font-weight: 600;" id="current-username-display">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                        <div style="font-size: 0.8rem; color: var(--text-muted);" id="user-role-display"></div>
                    </div>
                </div>
                <button onclick="logout()" class="btn-secondary" style="margin-top: 10px; width: 100%;">üö™ –í—ã–π—Ç–∏</button>
            </div>
        </div>
        
        <!-- –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –∫–æ–ª–æ–Ω–∫–∞ (–∫–æ–Ω—Ç–µ–Ω—Ç) -->
        <div class="main-chat">
            <!-- –í–∫–ª–∞–¥–∫–∞ –ß–ê–¢ -->
            <div id="tab-chat" class="tab-content active">
                <div class="chat-header">
                    <h3>üí¨ –û–±—â–∏–π —á–∞—Ç</h3>
                    <span id="chat-status" class="chat-status">–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...</span>
                </div>
                
                <div class="chat-container" id="chat-box">
                    <div style="text-align: center; color: var(--text-muted); padding: 20px;">–ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π...</div>
                </div>
                
                <div class="message-input-area">
                    <input type="text" id="message-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." disabled>
                    <input type="file" id="image-upload" accept="image/*" style="display: none;" disabled>
                    <button onclick="document.getElementById('image-upload').click()" class="btn-primary" style="width: auto; padding: 12px 20px;" title="–ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ" disabled>üì∑</button>
                    <button id="send-message" class="btn-primary" disabled>–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                </div>
            </div>
            
            <!-- –í–∫–ª–∞–¥–∫–∞ –£–ß–ê–°–¢–ù–ò–ö–ò -->
            <div id="tab-users" class="tab-content">
                <div class="chat-header">
                    <h3>üë• –£—á–∞—Å—Ç–Ω–∏–∫–∏ –∫–ª–∞—Å—Å–∞</h3>
                    <span id="users-count" class="chat-status">0</span>
                </div>
                
                <!-- –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å (–≤–∏–¥–Ω–∞ —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∞–º) -->
                <div id="admin-panel" style="display: none;">
                    <div style="background: linear-gradient(135deg, rgba(213,43,30,0.1) 0%, rgba(0,0,0,0.3) 100%); border-radius: var(--radius-lg); padding: 20px; margin-bottom: 20px; border-left: 4px solid var(--accent-red);">
                        <h4 style="color: var(--accent-red); margin-bottom: 15px; display: flex; align-items: center; gap: 8px;">
                            ‚ö° –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å
                        </h4>
                        
                        <div style="margin-bottom: 15px;">
                            <label style="display: block; margin-bottom: 8px; color: var(--text-secondary);">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–∞—Ç–æ–º:</label>
                            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                <button id="close-chat" class="btn-primary btn-danger" style="flex: 1;">üîí –ó–∞–∫—Ä—ã—Ç—å —á–∞—Ç</button>
                                <button id="open-chat" class="btn-primary" style="flex: 1;">üîì –û—Ç–∫—Ä—ã—Ç—å —á–∞—Ç</button>
                            </div>
                        </div>
                        
                        <div>
                            <label style="display: block; margin-bottom: 8px; color: var(--text-secondary);">–û–¥–æ–±—Ä–∏—Ç—å –∑–∞—è–≤–∫–∏:</label>
                            <select id="user-select" style="margin-bottom: 10px; width: 100%;">
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</option>
                            </select>
                            <button id="approve-user" class="btn-primary" style="width: 100%;">‚úÖ –û–¥–æ–±—Ä–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ</button>
                        </div>
                    </div>
                </div>
                
                <!-- –°–ø–∏—Å–æ–∫ –∑–∞—è–≤–æ–∫ (–¥–ª—è –∞–¥–º–∏–Ω–æ–≤) -->
                <div id="pending-users-section" style="margin-bottom: 20px; display: none;">
                    <h4 style="color: var(--accent-red); margin-bottom: 10px;">‚è≥ –û–∂–∏–¥–∞—é—Ç –æ–¥–æ–±—Ä–µ–Ω–∏—è</h4>
                    <div id="pending-users-list" class="user-list" style="max-height: 150px;">
                        <!-- –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
                
                <!-- –í—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ -->
                <h4 style="margin-bottom: 10px;">‚úÖ –ê–∫—Ç–∏–≤–Ω—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏</h4>
                <div id="approved-users-list" class="user-list" style="max-height: 300px;">
                    <!-- –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </div>
            
            <!-- –í–∫–ª–∞–¥–∫–∞ –õ–ò–ß–ù–´–ï –°–û–û–ë–©–ï–ù–ò–Ø -->
            <div id="tab-pm" class="tab-content">
                <div class="chat-header">
                    <h3>üíå –õ–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è</h3>
                    <span id="pm-receiver" class="chat-status">–Ω–∏–∫—Ç–æ –Ω–µ –≤—ã–±—Ä–∞–Ω</span>
                </div>
                
                <!-- –°–ø–∏—Å–æ–∫ –¥–∏–∞–ª–æ–≥–æ–≤ (—Å–ª–µ–≤–∞) –∏ —á–∞—Ç (—Å–ø—Ä–∞–≤–∞) –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞ -->
                <div style="display: flex; gap: 15px; height: 500px;">
                    <!-- –°–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ -->
                    <div style="width: 200px; background: var(--bg-tertiary); border-radius: var(--radius-lg); padding: 10px; overflow-y: auto;">
                        <div style="font-weight: 600; padding: 10px; border-bottom: 1px solid var(--border-color); margin-bottom: 10px;">
                            –î–∏–∞–ª–æ–≥–∏
                        </div>
                        <div id="pm-contacts-list">
                            <!-- –ö–æ–Ω—Ç–∞–∫—Ç—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Å—é–¥–∞ -->
                            <div style="text-align: center; color: var(--text-muted); padding: 20px;">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                        </div>
                    </div>
                    
                    <!-- –û–±–ª–∞—Å—Ç—å —á–∞—Ç–∞ -->
                    <div style="flex: 1; display: flex; flex-direction: column;">
                        <div id="pm-chat-box" style="flex: 1; overflow-y: auto; padding: 15px; background: var(--bg-tertiary); border-radius: var(--radius-lg); margin-bottom: 10px;">
                            <div style="text-align: center; color: var(--text-muted); padding: 20px;">–í—ã–±–µ—Ä–∏—Ç–µ —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞</div>
                        </div>
                        
                        <div style="display: flex; gap: 10px;">
                            <input type="text" id="pm-input" placeholder="–õ–∏—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." style="flex: 1;" disabled>
                            <button id="pm-send" class="btn-primary" style="width: auto;" disabled>‚û°Ô∏è</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- –í–∫–ª–∞–¥–∫–∞ –ü–†–û–§–ò–õ–¨ -->
            <div id="tab-profile" class="tab-content">
                <div class="chat-header">
                    <h3>üë§ –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</h3>
                </div>
                
                <div style="background: var(--bg-tertiary); border-radius: var(--radius-lg); padding: 30px; text-align: center;">
                    <div style="width: 100px; height: 100px; background: var(--accent-blue); border-radius: 50%; margin: 0 auto 20px; display: flex; align-items: center; justify-content: center; font-size: 3rem; color: white;">
                        <span id="profile-avatar">üë§</span>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <div style="font-size: 1.2rem; font-weight: 600; color: var(--text-primary);" id="profile-username">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                        <div style="font-size: 0.9rem; color: var(--text-muted);" id="profile-email">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                    </div>
                    <!-- –í–∫–ª–∞–¥–∫–∞ –ü–†–û–§–ò–õ–¨, –ø–æ—Å–ª–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ -->
                    <div style="margin-top: 20px;">
                        <h4 style="margin-bottom: 10px;">üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h4>
                        <div style="background: var(--bg-tertiary); border-radius: var(--radius-md); padding: 15px;">
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px;">
                                <span>Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span>
                                <button id="enable-notifications" class="btn-primary" style="width: auto; padding: 8px 16px;">–í–∫–ª—é—á–∏—Ç—å</button>
                            </div>
                            <div style="font-size: 0.8rem; color: var(--text-muted);">
                                –ü–æ–ª—É—á–∞–π—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –∏ –∑–∞—è–≤–∫–∞—Ö
                            </div>
                        </div>
                    </div>
                    <div style="background: var(--bg-secondary); border-radius: var(--radius-md); padding: 15px; text-align: left; margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid var(--border-color);">
                            <span style="color: var(--text-muted);">–†–æ–ª—å:</span>
                            <span style="color: var(--text-primary); font-weight: 600;" id="profile-role">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid var(--border-color);">
                            <span style="color: var(--text-muted);">–°—Ç–∞—Ç—É—Å:</span>
                            <span style="color: var(--text-primary); font-weight: 600;" id="profile-status">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 8px 0;">
                            <span style="color: var(--text-muted);">–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:</span>
                            <span style="color: var(--text-primary);" id="profile-created">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                        </div>
                    </div>
                    
                    <button onclick="logout()" class="btn-danger" style="width: 100%;">üö™ –í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞</button>
                </div>
            </div>
        </div>
        
        <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ (–¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞ - –±—ã—Å—Ç—Ä—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä) -->
        <div class="pm-section" style="display: flex; flex-direction: column;">
            <h4>üìå –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø</h4>
            
            <div id="quick-stats" style="margin-bottom: 20px;">
                <div style="background: var(--bg-tertiary); border-radius: var(--radius-md); padding: 15px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                        <span>–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤:</span>
                        <span style="font-weight: 600;" id="stat-users">0</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                        <span>–°–æ–æ–±—â–µ–Ω–∏–π —Å–µ–≥–æ–¥–Ω—è:</span>
                        <span style="font-weight: 600;" id="stat-messages">0</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span>–û–Ω–ª–∞–π–Ω:</span>
                        <span style="font-weight: 600; color: #4caf50;" id="stat-online">0</span>
                    </div>
                </div>
            </div>
            
            <h4>üé® –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ</h4>
            <div style="background: var(--bg-tertiary); border-radius: var(--radius-md); padding: 15px; text-align: center; font-size: 0.9rem; color: var(--text-muted);">
                <div style="margin-bottom: 10px;">–†—É—Å—Å–∫–∏–π —Ç—Ä–∏–∫–æ–ª–æ—Ä</div>
                <div style="display: flex; gap: 5px; justify-content: center;">
                    <span style="width: 30px; height: 30px; background: white; border-radius: 4px;"></span>
                    <span style="width: 30px; height: 30px; background: #0033a0; border-radius: 4px;"></span>
                    <span style="width: 30px; height: 30px; background: #d52b1e; border-radius: 4px;"></span>
                </div>
            </div>
            
            <div style="margin-top: auto; text-align: center; padding: 20px 0; color: var(--text-muted); font-size: 0.8rem;">
                ¬© 2026 6–í–º–µ—Å—Ç–µ<br>
                –°–¥–µ–ª–∞–Ω–æ –¥–ª—è –∫–ª–∞—Å—Å–∞
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabase-config.js"></script>
    <script src="script.js"></script>
    <!-- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Service Worker -->
    <script>
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', async () => {
            try {
                const registration = await navigator.serviceWorker.register('/sw.js');
                console.log('Service Worker –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω:', registration);
                
                // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                const permission = await Notification.requestPermission();
                console.log('–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:', permission);
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ Service Worker:', error);
            }
        });
    }
    </script>
</body>
</html>




